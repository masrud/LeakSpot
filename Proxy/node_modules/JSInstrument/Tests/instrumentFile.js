var fs = require('fs');
var JSInstrumentLib = require('../lib/JSInstrument.js');
var jsinstrument = new JSInstrumentLib();
function main() {
    var FILESUFFIX1 = "INS";
    if (process.argv.length < 3) {
        process.exit(1);
    }

    var filename = process.argv[2];
    //jsinstrument.setOptions({ parsing_mode: 'BEAUTIFIED' });
    jsinstrument.setOptions({ parsing_mode: 'PARSE' });
    console.log('Reading ' + filename);
    var code = fs.readFileSync(filename, 'utf8');
    var newCode = jsinstrument.instrument(code);

    var newFileName = filename.replace(".js", FILESUFFIX1+".js");
    fs.writeFileSync(newFileName, newCode, "utf8");
}

main();
